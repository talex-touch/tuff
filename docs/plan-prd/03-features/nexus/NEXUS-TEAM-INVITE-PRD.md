# Nexus Team Invite Feature PRD

## æ¦‚è¿°

å°†å½“å‰ "Join teams waitlist" å ä½ç¬¦æ›¿æ¢ä¸ºåŠŸèƒ½å®Œæ•´çš„å›¢é˜Ÿé‚€è¯·ç³»ç»Ÿã€‚

---

## å½“å‰çŠ¶æ€

Team preview é¡µé¢æ˜¾ç¤ºï¼š
- "Join teams waitlist" é“¾æ¥ï¼ˆå ä½ç¬¦ï¼‰
- "Roadmap updates and invite controls will surface here during the preview"

## ç›®æ ‡çŠ¶æ€

åŠŸèƒ½å®Œæ•´çš„å›¢é˜Ÿç®¡ç†ï¼š
1. **å›¢é˜Ÿé‚€è¯·ç”Ÿæˆ** - åˆ›å»ºå¯åˆ†äº«çš„é‚€è¯·é“¾æ¥
2. **é‚€è¯·ç è¾“å…¥** - é€šè¿‡é‚€è¯·ç åŠ å…¥å›¢é˜Ÿ
3. **æˆå‘˜ç®¡ç†** - æŸ¥çœ‹å’Œç®¡ç†å›¢é˜Ÿæˆå‘˜

---

## UI è®¾è®¡

### ç§»é™¤
- "Join teams waitlist" é“¾æ¥
- å…³äº roadmap updates çš„å ä½æ–‡æœ¬

### æ–°å¢

#### å›¢é˜Ÿæ‰€æœ‰è€…/ç®¡ç†å‘˜è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å›¢é˜Ÿç®¡ç†                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  é‚€è¯·æˆå‘˜                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ https://tuff.tagzxia.com/join/abc â”‚ [å¤åˆ¶]   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  [ç”Ÿæˆæ–°é“¾æ¥]  æœ‰æ•ˆæœŸ: 7 å¤©                      â”‚
â”‚                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”‚
â”‚                                                  â”‚
â”‚  æˆå‘˜ (3/5 å¸­ä½)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘¤ TalexDreamSoul (æ‰€æœ‰è€…)   [æ´»è·ƒ]     â”‚   â”‚
â”‚  â”‚ ğŸ‘¤ Member1          [æ´»è·ƒ]    [ç§»é™¤]    â”‚   â”‚
â”‚  â”‚ ğŸ‘¤ Member2          [å¾…ç¡®è®¤]  [æ’¤é”€]    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### éå›¢é˜Ÿç”¨æˆ·è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åŠ å…¥å›¢é˜Ÿ                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  æœ‰é‚€è¯·ç ï¼Ÿ                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚ è¾“å…¥é‚€è¯·ç ...              â”‚  [åŠ å…¥å›¢é˜Ÿ]    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                  â”‚
â”‚  æˆ–è€…åˆ›å»ºè‡ªå·±çš„å›¢é˜Ÿ                              â”‚
â”‚  [åˆ›å»ºå›¢é˜Ÿ] (éœ€è¦ Pro+ è®¢é˜…)                    â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API è®¾è®¡

### æ•°æ®åº“æ¨¡å‹

```sql
-- team_invites è¡¨
CREATE TABLE team_invites (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  team_id UUID NOT NULL REFERENCES teams(id) ON DELETE CASCADE,
  code VARCHAR(32) UNIQUE NOT NULL,
  created_by UUID NOT NULL REFERENCES users(id),
  expires_at TIMESTAMP,
  max_uses INT DEFAULT NULL,
  uses INT DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW(),
  revoked_at TIMESTAMP DEFAULT NULL
);

-- team_members è¡¨ (å¦‚æœä¸å­˜åœ¨)
CREATE TABLE team_members (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  team_id UUID NOT NULL REFERENCES teams(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  role VARCHAR(20) DEFAULT 'member', -- owner, admin, member
  status VARCHAR(20) DEFAULT 'active', -- active, pending, removed
  invited_by UUID REFERENCES users(id),
  joined_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(team_id, user_id)
);
```

### API Endpoints

```typescript
// ========== é‚€è¯·ç®¡ç† ==========

// ç”Ÿæˆé‚€è¯·é“¾æ¥
POST /api/teams/:teamId/invites
Headers: { Authorization: Bearer <token> }
Request: { 
  expiresIn?: '1d' | '7d' | '30d' | 'never',
  maxUses?: number 
}
Response: { 
  code: string,
  url: string,
  expiresAt: string | null,
  maxUses: number | null
}

// è·å–å›¢é˜Ÿçš„æ‰€æœ‰é‚€è¯·
GET /api/teams/:teamId/invites
Headers: { Authorization: Bearer <token> }
Response: { 
  invites: Array<{
    code: string,
    url: string,
    expiresAt: string | null,
    uses: number,
    maxUses: number | null,
    createdBy: { id: string, name: string },
    createdAt: string
  }>
}

// æ’¤é”€é‚€è¯·
DELETE /api/teams/:teamId/invites/:code
Headers: { Authorization: Bearer <token> }
Response: { success: boolean }

// ========== åŠ å…¥å›¢é˜Ÿ ==========

// é€šè¿‡é‚€è¯·ç åŠ å…¥
POST /api/teams/join
Headers: { Authorization: Bearer <token> }
Request: { code: string }
Response: { 
  teamId: string,
  teamName: string,
  role: string
}

// éªŒè¯é‚€è¯·ç ï¼ˆé¢„è§ˆï¼Œä¸åŠ å…¥ï¼‰
GET /api/teams/invites/:code/preview
Response: {
  valid: boolean,
  teamName?: string,
  teamDescription?: string,
  memberCount?: number,
  error?: string
}

// ========== æˆå‘˜ç®¡ç† ==========

// è·å–å›¢é˜Ÿæˆå‘˜åˆ—è¡¨
GET /api/teams/:teamId/members
Headers: { Authorization: Bearer <token> }
Response: { 
  members: Array<{
    id: string,
    userId: string,
    name: string,
    email: string,
    role: 'owner' | 'admin' | 'member',
    status: 'active' | 'pending',
    joinedAt: string
  }>,
  seats: { used: number, total: number }
}

// ç§»é™¤æˆå‘˜
DELETE /api/teams/:teamId/members/:userId
Headers: { Authorization: Bearer <token> }
Response: { success: boolean }

// æ›´æ–°æˆå‘˜è§’è‰²
PATCH /api/teams/:teamId/members/:userId
Headers: { Authorization: Bearer <token> }
Request: { role: 'admin' | 'member' }
Response: { success: boolean }

// ========== å›¢é˜Ÿç®¡ç† ==========

// åˆ›å»ºå›¢é˜Ÿ
POST /api/teams
Headers: { Authorization: Bearer <token> }
Request: { name: string, description?: string }
Response: { 
  teamId: string,
  teamName: string
}

// è·å–ç”¨æˆ·çš„å›¢é˜Ÿ
GET /api/user/teams
Headers: { Authorization: Bearer <token> }
Response: {
  teams: Array<{
    id: string,
    name: string,
    role: string,
    memberCount: number
  }>
}
```

---

## å‰ç«¯å®ç°

### æ–°å¢ç»„ä»¶

```
apps/nexus/app/components/team/
â”œâ”€â”€ TeamInviteCard.vue      # é‚€è¯·é“¾æ¥å¡ç‰‡
â”œâ”€â”€ TeamInviteInput.vue     # é‚€è¯·ç è¾“å…¥
â”œâ”€â”€ TeamMemberList.vue      # æˆå‘˜åˆ—è¡¨
â”œâ”€â”€ TeamMemberItem.vue      # å•ä¸ªæˆå‘˜é¡¹
â””â”€â”€ TeamCreateDialog.vue    # åˆ›å»ºå›¢é˜Ÿå¼¹çª—
```

### é¡µé¢ä¿®æ”¹

**`app/pages/dashboard/team.vue`**

```vue
<script setup lang="ts">
const { data: teamData } = await useFetch('/api/user/teams')
const hasTeam = computed(() => teamData.value?.teams?.length > 0)
</script>

<template>
  <div class="team-page">
    <!-- æœ‰å›¢é˜Ÿï¼šæ˜¾ç¤ºç®¡ç†ç•Œé¢ -->
    <template v-if="hasTeam">
      <TeamManagement :team="currentTeam" />
    </template>
    
    <!-- æ— å›¢é˜Ÿï¼šæ˜¾ç¤ºåŠ å…¥/åˆ›å»º -->
    <template v-else>
      <TeamJoinOrCreate />
    </template>
  </div>
</template>
```

### AccountSDK é›†æˆ

```typescript
// packages/utils/account/team.ts
export interface TeamSDK {
  // è·å–å½“å‰ç”¨æˆ·çš„å›¢é˜Ÿ
  getTeams(): Promise<Team[]>
  
  // æ£€æŸ¥æ˜¯å¦æœ‰å›¢é˜Ÿ
  hasTeam(): Promise<boolean>
  
  // è·å–å›¢é˜Ÿæˆå‘˜
  getTeamMembers(teamId: string): Promise<TeamMember[]>
  
  // ç”Ÿæˆé‚€è¯·
  createInvite(teamId: string, options?: InviteOptions): Promise<Invite>
  
  // é€šè¿‡é‚€è¯·ç åŠ å…¥
  joinTeam(code: string): Promise<Team>
  
  // ç¦»å¼€å›¢é˜Ÿ
  leaveTeam(teamId: string): Promise<void>
}
```

---

## æƒé™æ§åˆ¶

| æ“ä½œ | Owner | Admin | Member |
|------|-------|-------|--------|
| ç”Ÿæˆé‚€è¯·é“¾æ¥ | âœ… | âœ… | âŒ |
| æ’¤é”€é‚€è¯· | âœ… | âœ… | âŒ |
| æŸ¥çœ‹æˆå‘˜ | âœ… | âœ… | âœ… |
| ç§»é™¤æˆå‘˜ | âœ… | âœ… | âŒ |
| æ›´æ”¹è§’è‰² | âœ… | âŒ | âŒ |
| è§£æ•£å›¢é˜Ÿ | âœ… | âŒ | âŒ |

---

## é‚€è¯·é“¾æ¥æ ¼å¼

```
https://tuff.tagzxia.com/join/{code}

ç¤ºä¾‹: https://tuff.tagzxia.com/join/abc123xyz
```

é‚€è¯·ç è§„åˆ™ï¼š
- é•¿åº¦ï¼š8-12 å­—ç¬¦
- å­—ç¬¦é›†ï¼š`a-zA-Z0-9`
- ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…

---

## é”™è¯¯å¤„ç†

| é”™è¯¯ç  | è¯´æ˜ | ç”¨æˆ·æç¤º |
|--------|------|----------|
| `INVITE_EXPIRED` | é‚€è¯·å·²è¿‡æœŸ | "æ­¤é‚€è¯·é“¾æ¥å·²è¿‡æœŸ" |
| `INVITE_REVOKED` | é‚€è¯·å·²æ’¤é”€ | "æ­¤é‚€è¯·é“¾æ¥å·²å¤±æ•ˆ" |
| `INVITE_MAX_USES` | è¾¾åˆ°ä½¿ç”¨ä¸Šé™ | "æ­¤é‚€è¯·é“¾æ¥å·²è¾¾åˆ°ä½¿ç”¨æ¬¡æ•°ä¸Šé™" |
| `TEAM_FULL` | å›¢é˜Ÿå¸­ä½å·²æ»¡ | "è¯¥å›¢é˜Ÿå·²æ»¡å‘˜ï¼Œæ— æ³•åŠ å…¥" |
| `ALREADY_MEMBER` | å·²æ˜¯æˆå‘˜ | "æ‚¨å·²æ˜¯è¯¥å›¢é˜Ÿæˆå‘˜" |
| `NOT_AUTHORIZED` | æ— æƒé™ | "æ‚¨æ²¡æœ‰æ‰§è¡Œæ­¤æ“ä½œçš„æƒé™" |

---

## ä¼˜å…ˆçº§

**é«˜** - Team è®¡åˆ’æ ¸å¿ƒåŠŸèƒ½

## æ—¶é—´ä¼°ç®—

- åç«¯ API: ~3 å¤©
- æ•°æ®åº“è¿ç§»: ~0.5 å¤©
- å‰ç«¯ç»„ä»¶: ~2 å¤©
- æµ‹è¯•: ~1 å¤©

**æ€»è®¡: ~6.5 å¤©**
